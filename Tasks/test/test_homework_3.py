import pytest
from datetime import datetime, timedelta

from .. homework_3.array_decompressing import Movie


sample_result = [
    '2020-01-01 00:00:00',
    '2020-01-02 00:00:00',
    '2020-01-03 00:00:00',
    '2020-01-04 00:00:00',
    '2020-01-05 00:00:00',
    '2020-01-06 00:00:00',
    '2020-01-07 00:00:00',
    '2020-01-15 00:00:00',
    '2020-01-16 00:00:00',
    '2020-01-17 00:00:00',
    '2020-01-18 00:00:00',
    '2020-01-19 00:00:00',
    '2020-01-20 00:00:00',
    '2020-01-21 00:00:00',
    '2020-01-22 00:00:00',
    '2020-01-23 00:00:00',
    '2020-01-24 00:00:00',
    '2020-01-25 00:00:00',
    '2020-01-26 00:00:00',
    '2020-01-27 00:00:00',
    '2020-01-28 00:00:00',
    '2020-01-29 00:00:00',
    '2020-01-30 00:00:00',
    '2020-01-31 00:00:00',
    '2020-02-01 00:00:00',
    '2020-02-02 00:00:00',
    '2020-02-03 00:00:00',
    '2020-02-04 00:00:00',
    '2020-02-05 00:00:00',
    '2020-02-06 00:00:00',
    '2020-02-07 00:00:00',
]


def test_array_decompressing():
    m = Movie('sw', [
        (datetime(2020, 1, 1), datetime(2020, 1, 7)),
        (datetime(2020, 1, 15), datetime(2020, 2, 7))
    ])
    data_list = []
    for d in m.schedule():
        data_list.append(str(d))

    assert len(data_list) == len(sample_result)
    assert data_list == sample_result
